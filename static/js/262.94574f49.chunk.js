"use strict";(self.webpackChunktodo_woman_up=self.webpackChunktodo_woman_up||[]).push([[262],{9262:function(e,a,n){n.r(a),n.d(a,{default:function(){return C}});var t=n(2791),r=n(6881),s=n(5834),o=n(4165),c=n(5861),i=n(9015),u=n(3002),l=n(3190),p=n(1971);var m=n(885),d=n(4453);var h=n(9755),_="AvatarField_avatar_wrapper__HV2gf",f="AvatarField_avatar__RmQsX",x="AvatarField_avatar_upload_button__HwYmp",g="AvatarField_hidden__M+VVd",v="AvatarField_error__p1vWu",w="AvatarField_button_uploading_animation__5WqF8",b=n(184),N=function(){var e=(0,r.C)(p.My).photo,a=(0,r.C)(s.pZ),n=a.errors,N=a.avatarError,j=a.status,S=t.useRef(null),A=function(){var e=(0,r.T)(),a=(0,r.C)(p.My),n=a.photo,t=a.id;return function(){var a=(0,c.Z)((0,o.Z)().mark((function a(r){var c,m,h,_,f,x,g;return(0,o.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e((0,s.LV)()),!(h=null===(c=r.current)||void 0===c||null===(m=c.files)||void 0===m?void 0:m[0])||!t){a.next=23;break}return e((0,s.Sy)(s.gh.UPLOADING)),a.next=6,(0,l.PL)((0,l.hJ)(i.DB,"userData/".concat(t,"/user/"))).then((function(e){return e.docs[0].id}));case 6:if(_=a.sent,n.includes("firebase")&&null!==n&&(f=n.split("%2F")[2].split("?")[0],x=(0,d.iH)(i.$k,"".concat(t,"/avatar/").concat(f)),(0,d.oq)(x)),g=(0,d.iH)(i.$k,"".concat(t,"/avatar/").concat(h.name)),!(h.size<=3145728)){a.next=22;break}return a.prev=10,a.next=13,(0,d.KV)(g,h);case 13:(0,d.Jt)(g).then((function(a){i.EA&&(0,u.ck)(i.EA,{photoURL:a}),(0,l.r7)((0,l.JU)(i.DB,"userData/".concat(t,"/user/").concat(_)),{photo:a}),e((0,p.UI)(a)),e((0,s.Sy)(s.gh.SUCCESS))})),a.next=20;break;case 16:a.prev=16,a.t0=a.catch(10),e((0,s.Sy)(s.gh.ERROR)),alert("\u0410\u0432\u0430\u0442\u0430\u0440 \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u043b\u0441\u044f");case 20:a.next=23;break;case 22:e((0,s.sT)("avatar"));case 23:case"end":return a.stop()}}),a,null,[[10,16]])})));return function(e){return a.apply(this,arguments)}}()}(),C=t.useState(!1),y=(0,m.Z)(C,2),E=y[0],Z=y[1];return t.useEffect((function(){A(S)}),[E]),(0,b.jsxs)("fieldset",{className:_,children:[(0,b.jsx)("img",{className:f,src:e||h,alt:"\u0410\u0432\u0430\u0442\u0430\u0440\u043a\u0430"}),(0,b.jsx)("input",{className:g,ref:S,type:"file",name:"photo",id:"photo",accept:"image/jpeg",onChange:function(){return Z((function(e){return!e}))}}),(0,b.jsx)("button",{type:"button",disabled:j===s.gh.UPLOADING,className:"".concat(x," ").concat(j===s.gh.UPLOADING&&w),onClick:function(){var e;return null===(e=S.current)||void 0===e?void 0:e.click()},children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"}),N&&(0,b.jsx)("span",{className:v,children:n.avatar})]})},j={container:"Settings_container__ted4K",header:"Settings_header__eCHOc",form:"Settings_form__YiLQK",user_data:"Settings_user_data__TKjbW",password_wrapper:"Settings_password_wrapper__zOkgF",option:"Settings_option__Ww2+7",input:"Settings_input__z-jQg",error:"Settings_error__-616n",submit_button:"Settings_submit_button__44J0Q",button_uploading_animation:"Settings_button_uploading_animation__aWjSl",submitAnimation:"Settings_submitAnimation__H8Jvq"},S=function(){var e=(0,r.T)(),a=(0,r.C)(s.pZ),n=a.nameInput,o=a.emailInput,c=a.lastnameInput,i=a.errors,u=a.nameError,l=a.lastnameError,m=a.emailError,d=(0,r.C)(p.My),h=d.name,_=d.email,f=d.lastname;return t.useEffect((function(){h.length>0&&e((0,s.XL)({name:h,email:_,lastname:f}))}),[h]),(0,b.jsxs)("fieldset",{className:j.user_data,children:[(0,b.jsxs)("label",{className:j.option,children:["\u0418\u043c\u044f",(0,b.jsx)("input",{className:j.input,type:"text",name:"name",maxLength:40,onChange:function(a){return e((0,s.Zc)(a))},value:n})]}),u&&(0,b.jsx)("span",{className:j.error,children:i.name}),(0,b.jsxs)("label",{className:j.option,children:["\u0424\u0430\u043c\u0438\u043b\u0438\u044f",(0,b.jsx)("input",{className:j.input,type:"text",name:"lastname",maxLength:40,onChange:function(a){return e((0,s.Zc)(a))},value:c})]}),l&&(0,b.jsx)("span",{className:j.error,children:i.lastname}),(0,b.jsxs)("label",{className:j.option,children:["Email",(0,b.jsx)("input",{className:j.input,type:"text",name:"email",maxLength:40,onChange:function(a){return e((0,s.Zc)(a))},value:o})]}),m&&(0,b.jsx)("span",{className:j.error,children:i.email})]})},A=function(){var e=(0,r.T)(),a=(0,r.C)(s.pZ),n=a.currentPasswordInput,t=a.newPasswordInput,o=a.repeatNewPasswordInput,c=a.errors,i=a.currentPasswordError,u=a.newPasswordError,l=a.repeatPasswordError;return(0,b.jsxs)("fieldset",{className:j.password_wrapper,children:[(0,b.jsxs)("label",{className:j.option,children:["\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",(0,b.jsx)("input",{className:j.input,type:"password",name:"currentPassword",maxLength:30,onChange:function(a){return e((0,s.Zc)(a))},value:n})]}),i&&(0,b.jsx)("span",{className:j.error,children:c.wrongPassword}),(0,b.jsxs)("label",{className:j.option,children:["\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",(0,b.jsx)("input",{className:j.input,type:"password",name:"newPassword",maxLength:30,onChange:function(a){return e((0,s.Zc)(a))},value:t})]}),u&&(0,b.jsx)("span",{className:j.error,children:c.notMatch}),l&&(0,b.jsx)("span",{className:j.error,children:c.password}),(0,b.jsxs)("label",{className:j.option,children:["\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",(0,b.jsx)("input",{className:j.input,type:"password",name:"repeatNewPassword",maxLength:30,onChange:function(a){return e((0,s.Zc)(a))},value:o})]})]})},C=function(e){var a=e.showMenu,n=(0,r.T)(),m=(0,r.C)(s.pZ).status,d=function(){var e=(0,r.T)(),a=(0,r.C)(s.pZ),n=a.nameInput,t=a.lastnameInput,m=a.emailInput,d=a.newPasswordInput,h=a.currentPasswordInput,_=a.repeatNewPasswordInput,f=(0,r.C)(p.My).id;return(0,c.Z)((0,o.Z)().mark((function a(){var r,c,x,g,v,w,b;return(0,o.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e((0,s.LV)()),r=/^[\u0430-\u044f\u0451\u0410-\u042f\u0451a-zA-Z]+$/.test(n),c=/^[\u0430-\u044f\u0451\u0410-\u042f\u0451a-zA-Z]+$/.test(t),x=/^([a-zA-Z0-9\\.\\_\\-]+@[a-zA-Z0-9]+\.[a-zA-Z0-9]+)$/.test(m),g=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(d),a.next=7,(0,l.PL)((0,l.hJ)(i.DB,"userData/".concat(f,"/user/"))).then((function(e){return e.docs[0]}));case 7:if(v=a.sent,w=v.id,b=v.data().password,h!==b){a.next=33;break}if(e((0,s.Sy)(s.gh.UPLOADING)),!g||d!==_){a.next=29;break}if(a.prev=13,a.t0=i.EA,!a.t0){a.next=18;break}return a.next=18,(0,u.gQ)(i.EA,d);case 18:(0,l.r7)((0,l.JU)(i.DB,"userData/".concat(f,"/user/").concat(w)),{password:d}),e((0,s.Oo)()),e((0,s.Sy)(s.gh.SUCCESS)),a.next=27;break;case 23:a.prev=23,a.t1=a.catch(13),console.error(a.t1),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c");case 27:a.next=31;break;case 29:e((0,s.Sy)(s.gh.ERROR)),e((0,s.sT)("new password"));case 31:a.next=34;break;case 33:h.length&&e((0,s.sT)("current password"));case 34:if(!r&&e((0,s.sT)("name")),!c&&t.length&&e((0,s.sT)("lastname")),!x&&e((0,s.sT)("email")),r&&x&&(c||!t.length)){e((0,s.Sy)(s.gh.UPLOADING));try{(0,l.r7)((0,l.JU)(i.DB,"userData/".concat(f,"/user/").concat(w)),{name:n,lastname:t,email:m}),i.EA&&(0,u.ck)(i.EA,{displayName:"".concat(n," ").concat(t)}).then((function(){e((0,s.Sy)(s.gh.SUCCESS))})),i.EA&&(0,u.s)(i.EA,m).then((function(){e((0,s.Sy)(s.gh.SUCCESS))})),e((0,p.qC)(n)),e((0,p.QU)(t)),e((0,p.vV)(m))}catch(o){console.error(o),e((0,s.Sy)(s.gh.ERROR)),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f")}}case 38:case"end":return a.stop()}}),a,null,[[13,23]])})))}();return t.useEffect((function(){n((0,s.LV)())}),[]),(0,b.jsxs)("section",{className:"".concat(j.settings," ").concat(j.container),"data-menu":a,children:[(0,b.jsx)("h2",{className:j.header,children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"}),(0,b.jsxs)("form",{className:j.form,onSubmit:function(e){e.preventDefault(),d()},children:[(0,b.jsx)(N,{}),(0,b.jsx)(S,{}),(0,b.jsx)(A,{}),(0,b.jsx)("button",{disabled:m===s.gh.UPLOADING,type:"submit",className:"".concat(j.submit_button," ").concat(m===s.gh.UPLOADING&&j.button_uploading_animation),children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})}}}]);
//# sourceMappingURL=262.94574f49.chunk.js.map