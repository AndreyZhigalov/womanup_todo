"use strict";(self.webpackChunktodo_woman_up=self.webpackChunktodo_woman_up||[]).push([[475],{7475:function(e,a,n){n.r(a),n.d(a,{default:function(){return T}});var t=n(2791),s=n(6881),r=n(5834),c=n(4165),o=n(5861),l=n(9015),i=n(3002),u=n(3190),d=n(1971);var p=n(885),m=n(4453);var h=n(9755),_="AvatarField_avatar_wrapper__HV2gf",f="AvatarField_avatar__RmQsX",x="AvatarField_avatar_upload_button__HwYmp",v="AvatarField_hidden__M+VVd",w="AvatarField_error__p1vWu",g="AvatarField_button_uploading_animation__5WqF8",N=n(184),j=function(){var e=(0,s.C)(d.My).photo,a=(0,s.C)(r.pZ),n=a.errors,j=a.avatarError,b=a.status,C=t.useRef(null),S=function(){var e=(0,s.T)(),a=(0,s.C)(d.My),n=a.photo,t=a.id;return function(){var a=(0,o.Z)((0,c.Z)().mark((function a(s){var o,p,h,_,f,x,v;return(0,c.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e((0,r.LV)()),!(h=null===(o=s.current)||void 0===o||null===(p=o.files)||void 0===p?void 0:p[0])||!t){a.next=23;break}return e((0,r.Sy)(r.gh.UPLOADING)),a.next=6,(0,u.PL)((0,u.hJ)(l.DB,"userData/".concat(t,"/user/"))).then((function(e){return e.docs[0].id}));case 6:if(_=a.sent,n.includes("firebase")&&null!==n&&(f=n.split("%2F")[2].split("?")[0],x=(0,m.iH)(l.$k,"".concat(t,"/avatar/").concat(f)),(0,m.oq)(x)),v=(0,m.iH)(l.$k,"".concat(t,"/avatar/").concat(h.name)),!(h.size<=3145728)){a.next=22;break}return a.prev=10,a.next=13,(0,m.KV)(v,h);case 13:(0,m.Jt)(v).then((function(a){l.EA&&(0,i.ck)(l.EA,{photoURL:a}),(0,u.r7)((0,u.JU)(l.DB,"userData/".concat(t,"/user/").concat(_)),{photo:a}),e((0,d.UI)(a)),e((0,r.Sy)(r.gh.SUCCESS))})),a.next=20;break;case 16:a.prev=16,a.t0=a.catch(10),e((0,r.Sy)(r.gh.ERROR)),alert("\u0410\u0432\u0430\u0442\u0430\u0440 \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u043b\u0441\u044f");case 20:a.next=23;break;case 22:e((0,r.sT)("avatar"));case 23:case"end":return a.stop()}}),a,null,[[10,16]])})));return function(e){return a.apply(this,arguments)}}()}(),P=t.useState(!1),A=(0,p.Z)(P,2),y=A[0],E=A[1];return t.useEffect((function(){S(C)}),[y]),(0,N.jsxs)("fieldset",{className:_,children:[(0,N.jsx)("img",{className:f,src:e||h,alt:"\u0410\u0432\u0430\u0442\u0430\u0440\u043a\u0430"}),(0,N.jsx)("input",{className:v,ref:C,type:"file",name:"photo",id:"photo",accept:"image/jpeg",onChange:function(){return E((function(e){return!e}))}}),(0,N.jsx)("button",{type:"button",disabled:b===r.gh.UPLOADING,className:"".concat(x," ").concat(b===r.gh.UPLOADING&&g),onClick:function(){var e;return null===(e=C.current)||void 0===e?void 0:e.click()},children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"}),j&&(0,N.jsx)("span",{className:w,children:n.avatar})]})},b="UserDataField_user_data__NfkRl",C="UserDataField_option__PWHHd",S="UserDataField_input__GG8MT",P="UserDataField_error__7kZmt",A=function(){var e=(0,s.T)(),a=(0,s.C)(r.pZ),n=a.nameInput,c=a.emailInput,o=a.lastnameInput,l=a.errors,i=a.nameError,u=a.lastnameError,p=a.emailError,m=(0,s.C)(d.My),h=m.name,_=m.email,f=m.lastname;return t.useEffect((function(){h.length>0&&e((0,r.XL)({name:h,email:_,lastname:f}))}),[h]),(0,N.jsxs)("fieldset",{className:b,children:[(0,N.jsxs)("label",{className:C,children:["\u0418\u043c\u044f",(0,N.jsx)("input",{className:S,type:"text",name:"name",maxLength:40,onChange:function(a){return e((0,r.Zc)(a))},value:n})]}),i&&(0,N.jsx)("span",{className:P,children:l.name}),(0,N.jsxs)("label",{className:C,children:["\u0424\u0430\u043c\u0438\u043b\u0438\u044f",(0,N.jsx)("input",{className:S,type:"text",name:"lastname",maxLength:40,onChange:function(a){return e((0,r.Zc)(a))},value:o})]}),u&&(0,N.jsx)("span",{className:P,children:l.lastname}),(0,N.jsxs)("label",{className:C,children:["Email",(0,N.jsx)("input",{className:S,type:"text",name:"email",maxLength:40,onChange:function(a){return e((0,r.Zc)(a))},value:c})]}),p&&(0,N.jsx)("span",{className:P,children:l.email})]})},y="PasswordField_password_wrapper__QUQf1",E="PasswordField_option__n4P00",Z="PasswordField_input__P-Nbp",k="PasswordField_error__+RCfM",D=function(){var e=(0,s.T)(),a=(0,s.C)(r.pZ),n=a.currentPasswordInput,t=a.newPasswordInput,c=a.repeatNewPasswordInput,o=a.errors,l=a.currentPasswordError,i=a.newPasswordError,u=a.repeatPasswordError;return(0,N.jsxs)("fieldset",{className:y,children:[(0,N.jsxs)("label",{className:E,children:["\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",(0,N.jsx)("input",{className:Z,type:"password",name:"currentPassword",maxLength:30,onChange:function(a){return e((0,r.Zc)(a))},value:n})]}),l&&(0,N.jsx)("span",{className:k,children:o.wrongPassword}),(0,N.jsxs)("label",{className:E,children:["\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",(0,N.jsx)("input",{className:Z,type:"password",name:"newPassword",maxLength:30,onChange:function(a){return e((0,r.Zc)(a))},value:t})]}),i&&(0,N.jsx)("span",{className:k,children:o.notMatch}),u&&(0,N.jsx)("span",{className:k,children:o.password}),(0,N.jsxs)("label",{className:E,children:["\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",(0,N.jsx)("input",{className:Z,type:"password",name:"repeatNewPassword",maxLength:30,onChange:function(a){return e((0,r.Zc)(a))},value:c})]})]})},L="Settings_settings__D5LTd",U="Settings_header__eCHOc",I="Settings_form__YiLQK",F="Settings_submit_button__44J0Q",R="Settings_button_uploading_animation__aWjSl",T=function(){var e=(0,s.T)(),a=(0,s.C)(r.pZ).status,n=function(){var e=(0,s.T)(),a=(0,s.C)(r.pZ),n=a.nameInput,t=a.lastnameInput,p=a.emailInput,m=a.newPasswordInput,h=a.currentPasswordInput,_=a.repeatNewPasswordInput,f=(0,s.C)(d.My).id;return(0,o.Z)((0,c.Z)().mark((function a(){var s,o,x,v,w,g,N;return(0,c.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e((0,r.LV)()),s=/^[\u0430-\u044f\u0451\u0410-\u042f\u0451a-zA-Z]+$/.test(n),o=/^[\u0430-\u044f\u0451\u0410-\u042f\u0451a-zA-Z]+$/.test(t),x=/^([a-zA-Z0-9\\.\\_\\-]+@[a-zA-Z0-9]+\.[a-zA-Z0-9]+)$/.test(p),v=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(m),a.next=7,(0,u.PL)((0,u.hJ)(l.DB,"userData/".concat(f,"/user/"))).then((function(e){return e.docs[0]}));case 7:if(w=a.sent,g=w.id,N=w.data().password,h!==N){a.next=33;break}if(e((0,r.Sy)(r.gh.UPLOADING)),!v||m!==_){a.next=29;break}if(a.prev=13,a.t0=l.EA,!a.t0){a.next=18;break}return a.next=18,(0,i.gQ)(l.EA,m);case 18:(0,u.r7)((0,u.JU)(l.DB,"userData/".concat(f,"/user/").concat(g)),{password:m}),e((0,r.Oo)()),e((0,r.Sy)(r.gh.SUCCESS)),a.next=27;break;case 23:a.prev=23,a.t1=a.catch(13),console.error(a.t1),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c");case 27:a.next=31;break;case 29:e((0,r.Sy)(r.gh.ERROR)),e((0,r.sT)("new password"));case 31:a.next=34;break;case 33:h.length&&e((0,r.sT)("current password"));case 34:if(!s&&e((0,r.sT)("name")),!o&&t.length&&e((0,r.sT)("lastname")),!x&&e((0,r.sT)("email")),s&&x&&(o||!t.length)){e((0,r.Sy)(r.gh.UPLOADING));try{(0,u.r7)((0,u.JU)(l.DB,"userData/".concat(f,"/user/").concat(g)),{name:n,lastname:t,email:p}),l.EA&&(0,i.ck)(l.EA,{displayName:"".concat(n," ").concat(t)}).then((function(){e((0,r.Sy)(r.gh.SUCCESS))})),l.EA&&(0,i.s)(l.EA,p).then((function(){e((0,r.Sy)(r.gh.SUCCESS))})),e((0,d.qC)(n)),e((0,d.QU)(t)),e((0,d.vV)(p))}catch(c){console.error(c),e((0,r.Sy)(r.gh.ERROR)),alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f")}}case 38:case"end":return a.stop()}}),a,null,[[13,23]])})))}();return t.useEffect((function(){e((0,r.LV)())}),[]),(0,N.jsxs)("section",{className:L,children:[(0,N.jsx)("h2",{className:U,children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u043e\u0444\u0438\u043b\u044f"}),(0,N.jsxs)("form",{className:I,onSubmit:function(e){e.preventDefault(),n()},children:[(0,N.jsx)(j,{}),(0,N.jsx)(A,{}),(0,N.jsx)(D,{}),(0,N.jsx)("button",{disabled:a===r.gh.UPLOADING,type:"submit",className:"".concat(F," ").concat(a===r.gh.UPLOADING&&R),children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})}}}]);
//# sourceMappingURL=475.8314e7f5.chunk.js.map